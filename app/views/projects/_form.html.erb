<%= form_for(@project) do |f| %>
  <%= render 'shared/errors', object: @project %>

  <div class="profile-card margin-large-top">
    <div class="profile-card-header">
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="card-icon">
        <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/>
        <polyline points="14,2 14,8 20,8"/>
      </svg>
      <h2 class="profile-card-title">General</h2>
    </div>
    <div class="profile-card-content">
      <div class="field">
        <%= f.label :name %><br>
        <%= f.text_field :name, required: true, minlength: 1, class: 'w-96' %>
      </div>

      <div class="field">
        <%= f.label :data_curation_issue_tracker_url %><br>
        <%= f.text_field :data_curation_issue_tracker_url, class: 'w-96' %>
      </div>

      <% if @project.new_record? %>
        <div class="field">
          <%= check_box_tag('project[create_with_current_user]', '1', true) %>
          <%= f.label :add_me_to_the_project  %>
        </div>
      <% end %>
    </div>
  </div>

  <div class="profile-card">
    <div class="profile-card-header">
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="card-icon">
        <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/>
        <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/>
      </svg>
      <h2 class="profile-card-title">API Access Token</h2>
    </div>
    <div class="profile-card-content">
      <div class="field">
        <ul class="no_bullets">
          <li>
            <label>
              <%= check_box_tag 'project[set_new_api_access_token]', true %>
              Generate new token
            </label>
          </li>
          
          <li>
            <label>
              <%= check_box_tag 'project[clear_api_access_token]', true %> <span>Clear API acess token </span> <em> Disables public API access to all project data. </em>
            </label>
          </li>
        </ul>

      <% if Rails.env.production? && @project.complete_dwc_download_is_public? %>
        <div class="d-inline-block">
          <div class="token-warning">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line>
            </svg>
            <span>Data provider links to TaxonWorks data may depend on this access token, and in that case will break if it's cleared.</span>    
          </div>     
        </div>   
        <% end %>
      </div>

      <% if !is_project_member_by_id?(sessions_current_user_id, sessions_current_project_id) -%>
        <div class="field">
          <%= check_box_tag 'project[project_members_attributes][0][user_id]', sessions_current_user_id, true %> <%= f.label :add_yourself_to_project %><br>
        </div>
      <% end %>
    </div>
  </div>



  <div class="actions flex-row gap-small">
    <%= f.submit %> 
    
    <% if @project.persisted? %>
      <%= link_to 'Show', @project, class: 'button btn btn-primary' %>
    <%end%>
  </div>
<% end %>
