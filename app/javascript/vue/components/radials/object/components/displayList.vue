<template>
  <transition-group
    class="table-entrys-list"
    name="list-complete"
    tag="ul"
  >
    <li
      v-for="item in list"
      :key="item.id"
      class="list-complete-item flex-separate middle"
    >
      <span
        class="list-item"
        v-html="displayName(item)"
      />
      <div class="list-controls">
        <pdf-button
          v-if="pdf && item.hasOwnProperty('target_document')"
          :pdf="item.target_document"
        />
        <radial-annotator
          v-if="annotator"
          :global-id="item.global_id"
        />
        <span
          v-if="edit"
          class="circle-button btn-edit"
          @click="$emit('edit', Object.assign({}, item))"
          >Edit
        </span>
        <span
          class="circle-button btn-delete"
          @click="deleteItem(item)"
          >Remove
        </span>
      </div>
    </li>
  </transition-group>
</template>
<script>
import PdfButton from '../../pdfButton.vue'
import RadialAnnotator from '../annotator.vue'

export default {
  components: {
    PdfButton,
    RadialAnnotator
  },

  props: {
    list: {
      type: Array,
      default: () => []
    },

    label: {
      type: [String, Array],
      required: true
    },

    edit: {
      type: Boolean,
      default: false
    },

    pdf: {
      type: Boolean,
      default: false
    },

    annotator: {
      type: Boolean,
      default: false
    }
  },

  emits: ['delete', 'edit'],

  mounted() {
    this.$options.components['RadialAnnotator'] = RadialAnnotator
  },

  methods: {
    displayName(item) {
      if (typeof this.label === 'string') {
        return item[this.label]
      } else {
        let tmp = item
        this.label.forEach((label) => {
          tmp = tmp[label]
        })
        return tmp
      }
    },

    deleteItem(item) {
      if (
        window.confirm(
          `You're trying to delete this record. Are you sure want to proceed?`
        )
      ) {
        this.$emit('delete', item)
      }
    }
  }
}
</script>
